{{template "base" .}}

{{define "content"}}
       <div class="card mb-4">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h4 class="card-title mb-0">Customers List</h4>
                                <a class="btn btn-primary btn-sm" href="/customers/add">Add Customer</a >
                            </div>
                            <div class="card-body">
                                <table id="datatablesSimple">
                                    <thead>
                                        <tr>
                                            <th>First Name</th>
                                            <th>Last Name</th>
                                            <th>Email</th>
                                            <th>UserName</th>
                                         
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                  
                                    <tbody>
                                    {{$customers := index .Data "customers"}}
                                         {{range $customers}}
                                            <tr>
                                                <td>{{.FirstName}}</td>
                                                <td>{{.LastName}}</td>
                                                <td>{{.Email}} </td>
                                                <td>{{.Username}} </td>
                                                <td>
                                                <div class="btn-group" role="group" aria-label="Basic outlined example">
                                                    <a class="btn btn-outline-primary">View</a>
                                                    <a href= "/customers/{{.ID}}" class="btn btn-outline-primary">Edit</a>
                                                    <button onclick="DeleteUser({{.ID}})" class="btn btn-outline-danger">Delete</button>
                                                    </div>     
                                                </td>
                                            
                                            </tr>
                                         {{end}}
                                    </tbody>
                                </table>
                            </div>
                        </div>
{{end}}

{{define "js"}}

<script>
  function DeleteUser(userID) {
  
  var endpoint = "/customers/delete/" + userID
  console.log("the endpoint", userID)
  fetch(endpoint,{
      method: 'DELETE',
    })
  .then(response => {
    if (!response.ok) {
      throw new Error('something went wrng');
    }
    return response.json();  
  })
  .then(data => {
    console.log('user deleted');  
    window.location.reload(); //reload
 
  })
  .catch(error => {
    console.error('Error delete user:', error) 
  });

  }
</script>

{{end}}